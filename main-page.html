<!doctype html>
<html lang="en">

<head>
  <!-- Metadata and external styles -->
  <meta charset="utf-8" />
  <meta name="description" content="Contacts page for the contacts manager.">
  <title>My Contacts - Contact Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/main_page.css" />
  <script type="text/javascript" src="js/mainpage.js"></script>
  <script type="text/javascript" src="js/global.js"></script>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
      onMainpageLoad();
      showContacts()
    })
  </script>

</head>

<body>
  <!-- Top bar -->
  <header class="bar">
    <div class="brand">
        <!-- Logo and title -->
        <div class="logo"><span onclick="window.location.href='index.html'" style="cursor: pointer;">ðŸ“‡</span></div>
        <div class="titles">
            <strong><span onclick="window.location.href='index.html'" style="cursor: pointer;">Contact Manager</span></strong>
        </div>
    </div>
    <!-- Logout button -->
    <button id="logout-btn" class="btn btn-ghost" onclick="returnToLogin()">Logout</button>
  </header>
  <script>
    function returnToLogin() {
      Global.process_logout();
    }
  </script>

  <!-- Main content card -->
  <main class="card">
    <!-- Tools row for search functionality -->
    <div class="section">
      <!-- Welcome Text -->
      <div>
        <div class="welcome-group">
          <span class="welcome-label" id="welcomeLabel"></span>
        </div>
      </div>

      <!-- Add contact button -->
        <div class="section mb-4">
        <h2 class="section-title">Contacts</h2>
        <button id="open-add-modal" class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addContactModal">
            Add Contact +
        </button>
        </div>

      <div class="row stack-mobile">
        <!-- Search input -->
        <div class="input-group grow">
          <span class="input-label"><h2 class = "section-title">Search</h2></span>
          <input id="search" placeholder="Search name, email, or phone numberâ€¦">
        </div>
        <!-- Search buttons -->
        <div class="button-group">
          <button id="search-btn" class="btn" onclick="searchContacts()">Search</button>
          <button id="clear-search-btn" class="btn btn-ghost" onclick="clearSearch()">Clear</button>        
        </div>
      </div>
    </div>

    <!-- Contacts table -->
    <div class="section">
      <div class="table-wrap">
        <table id="table" class="table">
          <thead>
            <tr>
              <!-- Table headers -->
              <th>First Name</th>
              <th>Last Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th style="width:160px">Actions</th>
            </tr>
          </thead>
          <tbody id="table-body">
            <!-- Table rows will be dynamically populated by mainpage.js -->
          </tbody>
        </table>
      </div>
    </div>
  </main>
  <!-- Add Contact Modal -->
  <div class="modal fade" id="addContactModal" tabindex="-1" aria-labelledby="addContactModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addContactModalLabel">Add New Contact</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Input fields for Name, Email, and Phone -->
          <div class="mb-3">
            <label for="firstname" class="form-label">First Name</label>
            <input id="firstname" class="form-control" placeholder="First Name">
          </div>
          <div class="mb-3">
            <label for="lastname" class="form-label">Last Name</label>
            <input id="lastname" class="form-control" placeholder="Last Name">
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input id="email" class="form-control" placeholder="jane@example.com">
          </div>
          <div class="mb-3">
            <label for="phone" class="form-label">Phone</label>
            <input id="phone" class="form-control" placeholder="(555) 000-0000">
          </div>
          <p id="msg" class="msg text-danger" aria-live="polite"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="addContact()" data-bs-dismiss="modal">Add</button>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Reset modal fields when it closes
    document.addEventListener("DOMContentLoaded", function () {
        let addContactModal = document.getElementById("addContactModal");
        addContactModal.addEventListener("hidden.bs.modal", function () {
        document.getElementById("firstname").value = "";
        document.getElementById("lastname").value = "";
        document.getElementById("email").value = "";
        document.getElementById("phone").value = "";
        document.getElementById("msg").innerText = "";
        });
    });
  </script>
</body>
</html>