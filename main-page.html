<!doctype html>
<html lang="en">

<head>
  <!-- Metadata and external styles -->
  <meta charset="utf-8" />
  <meta name="description" content="Contacts page for the contacts manager.">
  <title>My Contacts - Contact Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/main_page.css" />
  <script type="text/javascript" src="js/mainpage.js"></script>
  <script type="text/javascript" src="js/global.js"></script>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
      onMainpageLoad();
      showContacts()
    })
  </script>

</head>

<body>
  <!-- Top bar -->
  <header class="bar">
    <div class="brand">
        <!-- Logo and title -->
        <div class="logo"><span onclick="window.location.href='index.html'" style="cursor: pointer;">ðŸ“‡</span></div>
        <div class="titles">
            <strong><span onclick="window.location.href='index.html'" style="cursor: pointer;">Contact Manager</span></strong>
        </div>
    </div>
    <!-- Logout button -->
    <button id="logout-btn" class="btn btn-ghost" onclick="returnToLogin()">Logout</button>
  </header>
  <script>
    function returnToLogin() {
      Global.process_logout();
    }
  </script>

  <!-- Main content card -->
  <main class="card">
    <!-- Tools row for search functionality -->
    <div class="section">
      <!-- Welcome Text -->
      <div>
        <div class="welcome-group">
          <span class="welcome-label" id="welcomeLabel"></span>
        </div>
      </div>
      <div class="row stack-mobile">
        <!-- Search input -->
        <div class="input-group grow">
          <span class="input-label"><h2 class = "section-title">Search</h2></span>
          <input id="search" placeholder="Search name, email, or phone numberâ€¦">
        </div>
        <!-- Search buttons -->
        <div class="button-group">
          <button id="search-btn" class="btn" onclick="searchContact()">Search</button>        
        </div>
      </div>
    </div>

    <!-- Add contact section -->
    <div class="section">
      <h2 class="section-title">Add Contact</h2>
      <div class="row stack-mobile">
        <!-- Input fields for Name, Email, and Phone -->
        <div class="input-group grow">
          <span class="input-label">First Name</span>
          <input id="firstname" placeholder="First Name">
        </div>
        <div class="input-group grow">
          <span class="input-label">Last Name</span>
          <input id="lastname" placeholder="Last Name">
        </div>
        <div class="input-group grow">
          <span class="input-label">Email</span>
          <input id="email" placeholder="jane@example.com">
        </div>
        <div class="input-group grow">
          <span class="input-label">Phone</span>
          <input id="phone" placeholder="(555) 000-0000">
        </div>
        <!-- Add button -->
        <button id="add-btn" class="btn btn-primary" onclick="addContact()">Add</button>
      </div>
      <!-- Message area for feedback -->
      <p id="msg" class="msg" aria-live="polite"></p>
    </div>

    <!-- Contacts table -->
    <div class="section">
      <div class="table-wrap">
        <table id="table" class="table">
          <thead>
            <tr>
              <!-- Table headers -->
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th style="width:160px">Actions</th>
            </tr>
          </thead>
          <tbody id="table-body">
            <!-- Table rows will be dynamically populated by mainpage.js -->
          </tbody>
        </table>
        <!-- Empty state message -->
        <div id="empty-state" class="empty-state hidden">
            <p>No contacts added yet.</p>
        </div>
      </div>
    </div>
  </main>
  <script>
    // Show or hide the empty state automatically when the table is empty
    const tbody = document.querySelector('#table tbody');
    const empty = document.querySelector('#empty-state');
    const observer = new MutationObserver(() => {
      // Check if the table has rows
      const hasRows = tbody.querySelectorAll('tr').length > 1;
      // Toggle the hidden class on the empty state
      empty.classList.toggle('hidden', hasRows);
    });
    // Observe changes to the table body
    observer.observe(tbody, { childList: true });
  </script>
</body>

</html>